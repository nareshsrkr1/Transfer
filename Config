#!/bin/bash

# Define the number of processes to run in parallel
NUM_PROCESSES=$(nproc)

# Use find to find all directories under /data, then use xargs to execute du in parallel, sort the output, and get the top 10
find /data -type d | xargs -P $NUM_PROCESSES -I {} du -h {} 2>/dev/null | sort -rh | head -n 10
